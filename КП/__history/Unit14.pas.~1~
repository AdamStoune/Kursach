unit Unit14;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ExtCtrls,
  Vcl.Imaging.jpeg;

type
  TQuestion = record
    ImageFileName: string;
    QuestionText: string;
    CorrectAnswer: Boolean;
  end;

  TForm14 = class(TForm)
    ImageQuestion: TImage;
    LabelQuestion: TLabel;
    ButtonYes: TButton;
    ButtonNo: TButton;
    LabelResult: TLabel;
    Image2: TImage;
    procedure FormCreate(Sender: TObject);
    procedure ButtonYesClick(Sender: TObject);
    procedure ButtonNoClick(Sender: TObject);
    procedure Image2Click(Sender: TObject);
  private
    Questions: array of TQuestion;
    CurrentQuestionIndex: Integer;
    CorrectAnswersCount: Integer;
    procedure DisplayQuestion(QuestionIndex: Integer);
    procedure ShowResult;
  end;

var
  Form14: TForm14;

implementation

{$R *.dfm}

uses Unit2;

procedure TForm14.FormCreate(Sender: TObject);
var
  FileLines: TStringList;
  i: Integer;
begin
  FileLines := TStringList.Create;
  try
    FileLines.LoadFromFile('quest.txt', TEncoding.UTF8);

    SetLength(Questions, FileLines.Count div 3);

    for i := 0 to Length(Questions) - 1 do
    begin
      Questions[i].ImageFileName := FileLines[i * 3];
      Questions[i].QuestionText := FileLines[i * 3 + 1];
      Questions[i].CorrectAnswer := StrToBool(FileLines[i * 3 + 2]);
    end;

    CurrentQuestionIndex := 0;
    CorrectAnswersCount := 0;

    DisplayQuestion(CurrentQuestionIndex);
  finally
    FileLines.Free;
  end;
end;

procedure TForm14.Image2Click(Sender: TObject);
begin
Form14.Hide;
Form2.Show;
end;

procedure TForm14.DisplayQuestion(QuestionIndex: Integer);
begin
  ImageQuestion.Picture.LoadFromFile(Questions[QuestionIndex].ImageFileName);
  LabelQuestion.Caption := Questions[QuestionIndex].QuestionText;
end;

procedure TForm14.ButtonYesClick(Sender: TObject);
begin
  if Questions[CurrentQuestionIndex].CorrectAnswer then
    Inc(CorrectAnswersCount);

  Inc(CurrentQuestionIndex);

  if CurrentQuestionIndex < Length(Questions) then
    DisplayQuestion(CurrentQuestionIndex)
  else
    ShowResult;
end;

procedure TForm14.ButtonNoClick(Sender: TObject);
begin
  if not Questions[CurrentQuestionIndex].CorrectAnswer then
    Inc(CorrectAnswersCount);

  Inc(CurrentQuestionIndex);

  if CurrentQuestionIndex < Length(Questions) then
    DisplayQuestion(CurrentQuestionIndex)
  else
    ShowResult;
end;

procedure TForm14.ShowResult;
var
  Score: Double;
begin
  Score := (CorrectAnswersCount / Length(Questions)) * 100;
  LabelResult.Caption := Format('Тест завершен! Правильных ответов: %d из %d (%.2f%%)', [CorrectAnswersCount, Length(Questions), Score]);
  ButtonYes.Enabled := False;
  ButtonNo.Enabled := False;
end;

end.
